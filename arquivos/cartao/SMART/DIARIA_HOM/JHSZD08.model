//JHSZD08  JOB (00,EV),'ID_EXECUTOR',TIME=1440,REGION=0M,
//         CLASS=A,MSGCLASS=T,MSGLEVEL=(1,1),TYPRUN=SCAN
/*ROUTE PRINT JES2PRD1
//*
//JOBLIB   DD DISP=SHR,DSN=DSNC10.DB2M.SDSNLOAD
//         DD DISP=SHR,DSN=HOM.V01.LOAD
//*
//**********************************************************************
//E001DELE EXEC PGM=IEFBR14
//SYSOUT   DD SYSOUT=*
//SYSPRINT DD SYSOUT=*
//SYSUT1   DD DISP=(MOD,DELETE),UNIT=SYSALLDA,SPACE=(TRK,(5,5)),
//         DSN=HOM.APX.MZ.BIM2.M994D994.DDATA_MOVIMENTO
//SYSUT2   DD DISP=(MOD,DELETE),UNIT=SYSALLDA,SPACE=(TRK,(5,5)),
//         DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT1
//SYSUT3   DD DISP=(MOD,DELETE),UNIT=SYSALLDA,SPACE=(TRK,(5,5)),
//         DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT2
//SYSUT4   DD DISP=(MOD,DELETE),UNIT=SYSALLDA,SPACE=(TRK,(5,5)),
//         DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT3
//SYSUT5   DD DISP=(MOD,DELETE),UNIT=SYSALLDA,SPACE=(TRK,(5,5)),
//         DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT4
//SYSUT6   DD DISP=(MOD,DELETE),UNIT=SYSALLDA,SPACE=(TRK,(5,5)),
//         DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT5
//SYSUT7   DD DISP=(MOD,DELETE),UNIT=SYSALLDA,SPACE=(TRK,(5,5)),
//         DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT7
//SYSUT8   DD DISP=(MOD,DELETE),UNIT=SYSALLDA,SPACE=(TRK,(5,5)),
//         DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT8
//SYSUT9   DD DISP=(MOD,DELETE),UNIT=SYSALLDA,SPACE=(TRK,(5,5)),
//         DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.DUPLICA.SORT
//SYSUT10  DD DISP=(MOD,DELETE),UNIT=SYSALLDA,SPACE=(TRK,(5,5)),
//         DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB307.SIAPX
//SYSUT11  DD DISP=(MOD,DELETE),UNIT=SYSALLDA,SPACE=(TRK,(5,5)),
//         DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB081.SIAPX.CXERRO
//SYSUT12  DD DISP=(MOD,DELETE),UNIT=SYSALLDA,SPACE=(TRK,(5,5)),
//         DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB081.SIAPX.CXPEPMES
//SYSUT13  DD DISP=(MOD,DELETE),UNIT=SYSALLDA,SPACE=(TRK,(5,5)),
//         DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB081.SIAPX.CXRELAT
//SYSUT14  DD DISP=(MOD,DELETE),UNIT=SYSALLDA,SPACE=(TRK,(5,5)),
//         DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB081.SIAPX.CXTOTAL
//SYSUT15  DD DISP=(MOD,DELETE),UNIT=SYSALLDA,SPACE=(TRK,(5,5)),
//         DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB081.SIAPX.CXPEND
//SYSUT16  DD DISP=(MOD,DELETE),UNIT=SYSALLDA,SPACE=(TRK,(5,5)),
//         DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB078.ESTAT
//SYSUT17  DD DISP=(MOD,DELETE),UNIT=SYSALLDA,SPACE=(TRK,(5,5)),
//         DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB082.SIAPX.MVSTA
//SYSUT18  DD DISP=(MOD,DELETE),UNIT=SYSALLDA,SPACE=(TRK,(5,5)),
//         DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB082.SIAPX.MVPRO
//*
//E001GET  EXEC PGM=FTP,REGION=0M,PARM='10.100.2.144'
//STEPLIB  DD DSN=TCPIP.SEZALOAD,DISP=SHR
//SYSTCPD  DD DSN=HOM1.TCPPARMS(TCPDATA),DISP=SHR
//SYSFTPD  DD DSN=HOM1.TCPPARMS(FTPSDATA),DISP=SHR
//SYSMDUMP DD SYSOUT=Z
//SYSOUT   DD SYSOUT=*
//INPUT    DD *
USERPROD USRPRD
LOCSITE TRACKS
LOCSITE PRIMARY=5000
LOCSITE SECONDARY=4000
LOCSITE LRECL=417 BLKSIZE=0 RECFM=FB
CD /UPLOAD/JV1/JDSZD08/ENTRADA
GET DDATA_MOVIMENTO.M994D994.TXT +
   'HOM.APX.MZ.BIM2.M994D994.DDATA_MOVIMENTO'
QUIT
//*
//**********************************************************************
//E003SORT EXEC PGM=SORT,REGION=0K
//SYSPRINT DD SYSOUT=*
//SORTMSG  DD SYSOUT=*
//SYSOUT   DD SYSOUT=*
//SORTIN   DD DSN=HOM.APX.MZ.BIM2.M994D994.DDATA_MOVIMENTO,DISP=SHR
//SORTOUT1 DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT1,
//         DISP=(,CATLG),LRECL=417,RECFM=FB,DSORG=PS,
//         UNIT=3390,SPACE=(TRK,(400,50),RLSE)
//SORTOUT2 DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT2,
//         DISP=(,CATLG),LRECL=417,RECFM=FB,DSORG=PS,
//         UNIT=3390,SPACE=(TRK,(400,50),RLSE)
//SORTOUT7 DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT7,
//         DISP=(,CATLG),LRECL=417,RECFM=FB,DSORG=PS,
//         UNIT=3390,SPACE=(TRK,(400,50),RLSE)
//SORTWK01 DD UNIT=SYSALLDA,SPACE=(CYL,(50,50))
//SYSIN    DD *
  SORT FIELDS=COPY
  OUTFIL FNAMES=SORTOUT1,REMOVECC,INCLUDE=(1,1,SS,NE,C'2,4,6')
  OUTFIL FNAMES=SORTOUT2,REMOVECC,INCLUDE=(1,1,SS,EQ,C'2')
  OUTFIL FNAMES=SORTOUT7,REMOVECC,INCLUDE=(1,1,SS,EQ,C'4,6')
//**********************************************************************
//E004SORT EXEC PGM=SORT,REGION=0K
//SYSPRINT DD SYSOUT=*
//SORTMSG  DD SYSOUT=*
//SYSOUT   DD SYSOUT=*
//AVERBA   DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT1,DISP=SHR
//CANCEL   DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT2,DISP=SHR
//DUPLICA  DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.DUPLICA.SORT,
//         DISP=(,CATLG),LRECL=417,RECFM=FB,DSORG=PS,
//         UNIT=3390,SPACE=(TRK,(400,50),RLSE)
//SORTOUT3 DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT3,
//         DISP=(,CATLG),LRECL=417,RECFM=FB,DSORG=PS,
//         UNIT=3390,SPACE=(TRK,(400,50),RLSE)
//SORTOUT4 DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT4,
//         DISP=(,CATLG),LRECL=417,RECFM=FB,DSORG=PS,
//         UNIT=3390,SPACE=(TRK,(400,50),RLSE)
//SORTWK02 DD UNIT=SYSALLDA,SPACE=(CYL,(50,50))
//SYSIN    DD *
  SORT FIELDS=(1,1,CH,A,4,4,CH,A)
  JOINKEYS F1=AVERBA,FIELDS=(04,04,A,
                             11,07,A,
                            142,12,A)
   JOINKEYS F2=CANCEL,FIELDS=(04,04,A,
                              11,07,A,
                             142,12,A)
   JOIN UNPAIRED,F1,F2
   REFORMAT FIELDS=(?,F1:1,417,F2:1,417)
   OUTFIL FNAMES=DUPLICA,INCLUDE=(1,1,CH,EQ,C'B'),
                 OUTREC=(1:2,417,/,1:419,417)
   OUTFIL FNAMES=SORTOUT3,INCLUDE=(1,1,CH,EQ,C'1'),BUILD=(1:2,417)
   OUTFIL FNAMES=SORTOUT4,INCLUDE=(1,1,CH,EQ,C'2'),BUILD=(1:419,417)
/*
//**********************************************************************
//E005SORT EXEC PGM=SORT,REGION=0K
//SYSPRINT DD SYSOUT=*
//SORTMSG  DD SYSOUT=*
//SYSOUT   DD SYSOUT=*
//SORTIN   DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT3,DISP=SHR
//         DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT4,DISP=SHR
//SORTOUT5 DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT5,
//         DISP=(,CATLG),LRECL=417,RECFM=FB,DSORG=PS,
//         UNIT=3390,SPACE=(TRK,(400,50),RLSE)
//SORTWK03 DD UNIT=SYSALLDA,SPACE=(CYL,(50,50))
//SYSIN    DD *
  SORT FIELDS=(1,1,CH,A,4,4,CH,A)
  OUTFIL FNAMES=SORTOUT5
//**********************************************************************
//E006SORT EXEC PGM=SORT,REGION=0K
//SYSPRINT DD SYSOUT=*
//SORTMSG  DD SYSOUT=*
//SYSOUT   DD SYSOUT=*
//SORTIN   DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT5,DISP=SHR
//         DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT7,DISP=SHR
//SORTOUT8 DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT8,
//         DISP=(,CATLG),LRECL=417,RECFM=FB,DSORG=PS,
//         UNIT=3390,SPACE=(TRK,(400,50),RLSE)
//SORTWK03 DD UNIT=SYSALLDA,SPACE=(CYL,(50,50))
//SYSIN    DD *
  SORT FIELDS=COPY
  OUTFIL FNAMES=SORTOUT8
//**       =======================================================
//**       PROCESSAMENTO REPASSES SIAPX
//**       =======================================================
//E0070402 EXEC PGM=IKJEFT01,DYNAMNBR=20
//SYSTSPRT DD SYSOUT=*
//SYSPRINT DD SYSOUT=*
//SYSUDUMP DD SYSOUT=Z
//SYSOUT   DD SYSOUT=*
//SZMOVTO  DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB402.SORT8,DISP=SHR
//SYSDBOUT DD SYSOUT=*
//SYSABOUT DD SYSOUT=*
//SYSTSIN  DD *
    DSN    SYSTEM(DB2M)
    RUN    PROGRAM(SZEMB402) PLAN(SIASBAT) -
           LIB('HOM.V01.LOAD')            -
           PARMS('/ABTERMENC(ABEND)')
//SYSIN    DD *
006204APXPHOM.APX.MZ.BIM2.M994D994.DDATA_MOVIMENTO
//**       =======================================================
//**       GERACAO RELATORIO DE ACOMPANHAMENTO DISEF
//**       =======================================================
//E0080081 EXEC PGM=IKJEFT01,DYNAMNBR=20,COND=(00,NE)
//SYSTSPRT DD SYSOUT=*
//SYSUDUMP DD SYSOUT=*
//SYSOUT   DD SYSOUT=*
//CXERRO   DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB081.SIAPX.CXERRO,
//         DISP=(,CATLG,),SPACE=(TRK,(4000,4000),RLSE),
//         UNIT=3390,VOL=SER=(HOM008),
//         DCB=(RECFM=FB,LRECL=466,BLKSIZE=0,DSORG=PS)
//CXPEPMES DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB081.SIAPX.CXPEPMES,
//         DISP=(,CATLG,),SPACE=(TRK,(4000,4000),RLSE),
//         UNIT=3390,VOL=SER=(HOM008),
//         DCB=(RECFM=FB,LRECL=953,BLKSIZE=0,DSORG=PS)
//CXRELAT  DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB081.SIAPX.CXRELAT,
//         DISP=(,CATLG,),SPACE=(TRK,(4000,4000),RLSE),
//         UNIT=3390,VOL=SER=(HOM008),
//         DCB=(RECFM=FB,LRECL=600,BLKSIZE=0,DSORG=PS)
//CXTOTAL  DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB081.SIAPX.CXTOTAL,
//         DISP=(,CATLG,),SPACE=(TRK,(4000,4000),RLSE),
//         UNIT=3390,VOL=SER=(HOM008),
//         DCB=(RECFM=FB,LRECL=100,BLKSIZE=0,DSORG=PS)
//CXPEND   DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB081.SIAPX.CXPEND,
//         DISP=(,CATLG,),SPACE=(TRK,(4000,4000),RLSE),
//         UNIT=3390,VOL=SER=(HOM008),
//         DCB=(RECFM=FB,LRECL=232,BLKSIZE=0,DSORG=PS)
//SYSDBOUT DD SYSOUT=*
//SYSABOUT DD SYSOUT=*
//SYSTSIN  DD *
    DSN    SYSTEM(DB2M)
    RUN    PROGRAM(SZEMB081) PLAN(SIASBAT) -
           LIB('HOM.V01.LOAD')            -
           PARMS('/ABTERMENC(ABEND)')
//SYSIN    DD *
HOM.APX.MZ.BIM2.M994D994.DDATA_MOVIMENTO
//**       =======================================================
//**       CARGA DOS CONTRATOS
//**       =======================================================
//E0090307 EXEC PGM=IKJEFT01,DYNAMNBR=20,COND=(00,NE)
//SYSTSPRT DD SYSOUT=*
//SYSUDUMP DD SYSOUT=*
//SYSOUT   DD SYSOUT=*
//CXSAIDA  DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB307.SIAPX,
//         DISP=(,CATLG,CATLG),
//         UNIT=3390,SPACE=(TRK,(500,500),RLSE),
//         DCB=(RECFM=FB,LRECL=400,BLKSIZE=0,DSORG=PS)
//SYSDBOUT DD SYSOUT=*
//SYSABOUT DD SYSOUT=*
//SYSTSIN  DD *
    DSN    SYSTEM(DB2M)
    RUN    PROGRAM(SZEMB307) PLAN(SIASBAT) -
           LIB('HOM.V01.LOAD')            -
           PARMS('/ABTERMENC(ABEND)')
//SYSIN    DD *
006204APXPHOM.APX.MZ.BIM2.M994D994.DDATA_MOVIMENTO
//**       =======================================================
//**       GERACAO DE FATURAS
//**       =======================================================
//E0100058 EXEC PGM=IKJEFT01,DYNAMNBR=20,COND=(00,NE)
//SYSTSPRT DD SYSOUT=*
//SYSUDUMP DD SYSOUT=*
//SYSOUT   DD SYSOUT=*
//SYSDBOUT DD SYSOUT=*
//SYSABOUT DD SYSOUT=*
//SYSTSIN  DD *
    DSN    SYSTEM(DB2M)
    RUN    PROGRAM(SZEMB058) PLAN(SIASBAT) -
           LIB('HOM.V01.LOAD')            -
           PARMS('/ABTERMENC(ABEND)')
//SYSIN    DD *
2016120120&UDUMA
//**       =======================================================
//**       GERACAO SIGPF
//**       =======================================================
//E0120082 EXEC PGM=IKJEFT01,DYNAMNBR=20,COND=(00,NE,E0090307)
//SYSTSPRT DD SYSOUT=*
//SYSUDUMP DD SYSOUT=*
//SYSOUT   DD SYSOUT=*
//CXSAI100 DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB082.SIAPX.MVSTA,
//         DISP=(,CATLG,CATLG),
//         UNIT=3390,SPACE=(TRK,(500,500),RLSE),
//         DCB=(RECFM=FB,LRECL=100,BLKSIZE=0,DSORG=PS)
//CXSAI300 DD DSN=HOM.SZ.DDATA_MOVIMENTO.SZEMB082.SIAPX.MVPRO,
//         DISP=(,CATLG,CATLG),
//         UNIT=3390,SPACE=(TRK,(500,500),RLSE),
//         DCB=(RECFM=FB,LRECL=300,BLKSIZE=0,DSORG=PS)
//SYSDBOUT DD SYSOUT=*
//SYSABOUT DD SYSOUT=*
//SYSTSIN  DD *
    DSN    SYSTEM(DB2M)
    RUN    PROGRAM(SZEMB082) PLAN(SIASBAT) -
           LIB('HOM.V01.LOAD')            -
           PARMS('/ABTERMENC(ABEND)')
//SYSIN    DD *
006204APXPHOM.APX.MZ.BIM2.M994D994.DDATA_MOVIMENTO
//**       =======================================================
//**       EMISSAO E BAIXA ENDOSSOS AUTOMATICA
//**       =======================================================
//**********************************************************************
//E0140074 EXEC PGM=IKJEFT01,DYNAMNBR=20
//SYSTSPRT DD SYSOUT=*
//SYSUDUMP DD SYSOUT=*
//SYSOUT   DD SYSOUT=*
//SYSDBOUT DD SYSOUT=*
//SYSABOUT DD SYSOUT=*
//SYSTSIN  DD *
    DSN    SYSTEM(DB2M)
    RUN    PROGRAM(SZEMB074) PLAN(SIASBAT) -
           LIB('HOM.V01.LOAD')            -
           PARMS('/ABTERMENC(ABEND)')
//SYSIN    DD DUMMY
//**********************************************************************
//E015FTP  EXEC PGM=FTP,REGION=4096K,TIME=NOLIMIT,
//         PARM='10.100.2.144'
//STEPLIB  DD DSN=TCPIP.SEZALOAD,DISP=SHR
//SYSTCPD  DD DSN=HOM1.TCPPARMS(TCPDATA),DISP=SHR
//SYSFTPD  DD DSN=HOM1.TCPPARMS(FTPSDATA),DISP=SHR
//SYSMDUMP DD SYSOUT=Z
//SYSPRINT DD SYSOUT=*
//SYSOUT   DD SYSOUT=*
//INPUT    DD *
USERPROD USRPRD
CD /UPLOAD/JV1/JDSZD08/SAIDA
PUT 'HOM.SZ.DDATA_MOVIMENTO.SZEMB081.SIAPX.CXERRO'         +
            DDATA_MOVIMENTO.SZEMB081.SIAPX.CXERRO.TXT
PUT 'HOM.SZ.DDATA_MOVIMENTO.SZEMB081.SIAPX.CXRELAT'        +
            DDATA_MOVIMENTO.SZEMB081.SIAPX.CXRELAT.TXT
PUT 'HOM.SZ.DDATA_MOVIMENTO.SZEMB081.SIAPX.CXTOTAL'        +
            DDATA_MOVIMENTO.SZEMB081.SIAPX.CXTOTAL.TXT
PUT 'HOM.SZ.DDATA_MOVIMENTO.SZEMB081.SIAPX.CXPEPMES'       +
            DDATA_MOVIMENTO.SZEMB081.SIAPX.CXPEPMES.TXT
PUT 'HOM.SZ.DDATA_MOVIMENTO.SZEMB081.SIAPX.CXPEND'         +
            DDATA_MOVIMENTO.SZEMB081.SIAPX.CXPEND.TXT
PUT 'HOM.SZ.DDATA_MOVIMENTO.SZEMB082.SIAPX.MVSTA'          +
            DDATA_MOVIMENTO.SZEMB082.SIAPX.MVSTA.TXT
PUT 'HOM.SZ.DDATA_MOVIMENTO.SZEMB082.SIAPX.MVPRO'          +
            DDATA_MOVIMENTO.SZEMB082.SIAPX.MVPRO.TXT
PUT 'HOM.SZ.DDATA_MOVIMENTO.SZEMB078.ESTAT'                +
            DDATA_MOVIMENTO.SZEMB078.ESTAT.TXT
PUT 'HOM.APX.MZ.BIM2.M994D994.DDATA_MOVIMENTO'             +
            DDATA_MOVIMENTO.M994D994.TXT
QUIT
//
